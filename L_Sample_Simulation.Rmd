---
title: Empirical Investigation of the performance of the large-sample interval estimation
  procedure
output:
  html_document:
    df_print: paged
---

## A Hundreds Confidence Intervals with exponentail distribution with 0.1 rate

```{r}
n_sample = 100                # n_sample : size of a sample
exp_rate = 0.1                # exponential distribution's rate
pop_mean = 1/exp_rate         # population mean in exponential distribution
```

### Make the replication of samples : Simulate 100 times

I've refered http://rstudio-pubs-static.s3.amazonaws.com/14397_870815b73be84c8e96f06a20772a13a1.html
and fixed somewhat.

```{r}
set.seed(9)
samples <- replicate(100, rexp(n_sample, exp_rate))
dim(samples)
```

### Make a interval matrix being generated by calculating confidence intervals

norm_int : a matrix with normally distributed confidence intervals
z_alpha_over_2 : z_{alpha/2}

```{r}
norm_int <- matrix(NA, nrow = dim(samples)[2], ncol = 6)
z_alpha_over_2 = qnorm(0.975)

for (i in 1:dim(samples)[2]) {
    mean = mean(samples[ , i])
    std = sd(samples[ , i])
    n_s = n_sample
    lcl = mean - z_alpha_over_2 * (std /sqrt(n_s))
    ucl = mean + z_alpha_over_2 * (std /sqrt(n_s))
    
    check_include = '-'
    
    if (pop_mean < lcl || pop_mean > ucl) {
      check_include = '*'
    }
    
    vec = c(check_include, i, lcl, mean, ucl, std)
    norm_int[i, ] = vec
}
colnames(norm_int) <- c("check", "Sample", "LCL", "Mean", "UCL", "s")
```

Convert norm_int into data.frame

```{r}
norm_int = data.frame(norm_int)
head(norm_int, 100)
```


### Find the number of intervals which doesn't include population mean

```{r}
indx = (norm_int$check == '*')
sum(indx)
```

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
